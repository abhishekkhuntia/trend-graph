!function(t,a){"object"==typeof exports&&"undefined"!=typeof module?a(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common"],a):a(t.TrendGraphModule={},t.ng.core,t._angular_common)}(this,function(t,a,e){"use strict";var i=function(){return function(t){console.log("BASELINE CONSTRUCTOR >>",t),this.yValue=t.yValue?t.yValue:"0",this.borderColor=t.borderColor?t.borderColor:"#ddd",this.borderWidth=t.borderWidth?t.borderWidth:"1",this.belowBaseLineColor=t.belowBaseLineColor?t.belowBaseLineColor:"red"}}(),r=function(){function t(){}return t.prototype.ngOnInit=function(){this.validateStatus=!1,this.canvas=this.tgraph.nativeElement,this.ctx=this.canvas.getContext("2d"),this.max_unit=this.max_abs_value=this.max_value=this.vertical_height_margin=this.data_margin=this.min_value=0,this.baseline=void 0!=this.baseline?new i(this.baseline):null,void 0!=this.data?this.validateGraphInput(this.data):console.error("GRAPH DATA IS >> UNDEFINED"),this.gradient="#484848"},t.prototype.validateGraphInput=function(t){t.constructor==Array?(this.setDataMargin(t),this.getMax(t),this.drawGraph(t),null!=this.baseline&&this.drawBaseline(this.baseline)):console.error("!!GRAPH DATA NEEDS TO BE ARRAY OF DATASETS!!")},t.prototype.refreshData=function(t){this.data=t,this.validateGraphInput(t)},t.prototype.setDataMargin=function(t){var a=0;t.forEach(function(t){a=t.data.length>a?t.data.length:a}),this.data_margin=this.ctx.canvas.width/a},t.prototype.drawGraph=function(t){var a=this;console.log(">> DRAW GRAPH >>"),this.max_abs_value>0?this.vertical_height_margin=(this.ctx.canvas.height-20)/this.max_abs_value:this.vertical_height_margin=this.ctx.canvas.height-20;var e=0;t.forEach(function(t){var i=t.borderColor;t.data.forEach(function(r,o){var n={};n={left:e,top:a.calcHeight(r),value:r};var s={};e+=a.data_margin,o+1!==t.data.length?s={left:e,top:a.calcHeight(t.data[o+1]),value:t.data[o+1]}:(s=n,a.plotCircle(s,i),e=0),null!=a.baseline?a.plotChart(n,s,i,a.baseline.belowBaseLineColor,t.borderWidth):a.plotChart(n,s,i,i,t.borderWidth)})})},t.prototype.plotChart=function(t,a,e,i,r){var o=this.ctx,n=1;o.beginPath(),this.gradient=o.createLinearGradient(0,this.canvas.height,0,0),null!=this.baseline&&(n=1-this.calcHeight(this.baseline.yValue)/this.canvas.height);try{this.gradient.addColorStop("0",i),this.gradient.addColorStop(n,i),this.gradient.addColorStop(n,e),this.gradient.addColorStop("1.00",e),o.strokeStyle=this.gradient}catch(t){console.warn("Config Error>, error in processing the values"),this.gradient=e,o.strokeStyle=e}o.lineWidth=r,o.moveTo(t.left,t.top),o.lineTo(a.left,a.top),o.fillStyle="#f0f0f0",o.fill(),o.stroke()},t.prototype.plotCircle=function(t,a){var e=this.ctx;e.beginPath(),e.moveTo(e.left,e.top),e.arc(t.left,t.top,2.5,0,2*Math.PI,!0);try{e.strokeStyle=this.gradient}catch(t){e.strokeStyle=a}e.fill(),e.stroke()},t.prototype.getMax=function(t){var a,e,i=this;a=this.max_value=t[0].data[0],e=this.min_value=t[0].data[0],t.forEach(function(t){e=i.min_value,a=i.max_value,t.data.forEach(function(t){a=t>a?t:a,e=t<e?t:e}),i.min_value=e,i.max_value=a}),e<0&&a>0?this.max_abs_value=a+Math.abs(e):a<0?this.max_abs_value=Math.abs(e):0==a?this.max_abs_value=Math.abs(e):a>=0&&e>=0&&(this.max_abs_value=a),this.min_value=e,this.max_value=a},t.prototype.calcHeight=function(t){if(this.max_abs_value>0){if(this.max_value<=0&&this.min_value>=0){var a=this.max_value<=0?this.max_value:this.min_value;return Math.floor(this.vertical_height_margin*(a-t+5))}return Math.floor(this.vertical_height_margin*(this.max_value-t+5))}return Math.floor(this.vertical_height_margin)},t.prototype.drawBaseline=function(t){this.drawHorizontalLine(t.yValue,t.borderColor,t.borderWidth)},t.prototype.drawHorizontalLine=function(t,a,e){t=this.calcHeight(t),this.ctx.beginPath(),this.ctx.moveTo(0,t),this.ctx.lineTo(this.canvas.width,t),this.ctx.lineWidth=e,this.ctx.strokeStyle=a,this.ctx.stroke()},t}();r.decorators=[{type:a.Component,args:[{selector:"trend-graph",template:'<canvas #tgraph class="gclass"></canvas>',styles:["\n    .gclass{}\n  "]}]}],r.ctorParameters=function(){return[]},r.propDecorators={tgraph:[{type:a.ViewChild,args:["tgraph"]}],data:[{type:a.Input}],baseline:[{type:a.Input}]};var o=function(){return function(){}}();o.decorators=[{type:a.NgModule,args:[{imports:[e.CommonModule],declarations:[r],exports:[r]}]}],o.ctorParameters=function(){return[]},t.TrendGraphModule=o,t.TrendGraphComponent=r,Object.defineProperty(t,"__esModule",{value:!0})});